#!/bin/sh
GREEN='\033[0;32m'

VERSION=0.0.2

echo "${GREEN}\n\n\n##########################################################################################${NC}"
echo "${GREEN}##########################################################################################${NC}"
echo "${GREEN}########################### Start Gradle Compile - Service A #############################${NC}"
echo "${GREEN}##########################################################################################${NC}"
echo "${GREEN}##########################################################################################${NC}\n\n\n"

    ./gradlew :services:service-a:build -Dquarkus.package.type=uber-jar

echo "${GREEN}\n\n\n##########################################################################################${NC}"
echo "${GREEN}##########################################################################################${NC}"
echo "${GREEN}########################### Docker build & push - Service A ##############################${NC}"
echo "${GREEN}##########################################################################################${NC}"
echo "${GREEN}##########################################################################################${NC}\n\n\n"

  docker build -t quay.io/appdev_playground/service-mesh-basic-example:service-a-$VERSION -f services/service-a/metadata/Dockerfile services/service-a --platform linux/amd64
  docker push quay.io/appdev_playground/service-mesh-basic-example:service-a-$VERSION

echo "${GREEN}\n\n\n##########################################################################################${NC}"
echo "${GREEN}##########################################################################################${NC}"
echo "${GREEN}########################### OpenShift deployi - Service A ################################${NC}"
echo "${GREEN}##########################################################################################${NC}"
echo "${GREEN}##########################################################################################${NC}\n\n\n"